<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-05-09" />

<title>Calculate D-score and DAZ</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Calculate D-score and DAZ</h1>
<h4 class="date"><em>2017-05-09</em></h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This vignettes shows how to estimate the D-score and the D-score SDS, a.k.a. DAZ in an excerpt from the POPS data. This vignettes covers some typical actions needed when estimating D-scores:</p>
<ol style="list-style-type: decimal">
<li>Rename item names in source data to item names used in itembank</li>
<li>Reorganize the source data into a long matrix</li>
<li>Calculate D-score and DAZ</li>
<li>Combine D-score and DAZ with source data</li>
</ol>
</div>
<div id="rename-item-names" class="section level2">
<h2>Rename item names</h2>
<p>The <code>dscore</code> package has built-in example data from the POPS study, called <code>popsdemo</code>. The data set is of class <code>tbl_df</code> from the <code>dplyr</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;dscore&quot;</span>)

popsdemo</code></pre></div>
<pre><code>## # A tibble: 100 Ã— 67
##    patid gender gestationalage moment   age   occ daycor  dead Fixateseyes
##    &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
## 1      1      2       30.28571      2   161     1     95     0           0
## 2      1      2       30.28571      3   301     2    236     0         NaN
## 3      1      2       30.28571      4   511     3    443     0         NaN
## 4      1      2       30.28571      5  1008     4    940     0         NaN
## 5      4      1       32.42857      2   140     1     93     0           0
## 6      4      1       32.42857      3   231     2    184     0         NaN
## 7      4      1       32.42857      4   420     3    368     0         NaN
## 8      4      1       32.42857      5   763     4    716     0         NaN
## 9      5      1       31.57143      2   147     1     94     0           0
## 10     5      1       31.57143      3   238     2    185     0         NaN
## # ... with 90 more rows, and 58 more variables: Reactstospeech &lt;dbl&gt;,
## #   Movesbotharmsequallyasmuch &lt;dbl&gt;, Movesbothlegsequallyasmuch &lt;dbl&gt;,
## #   Liftschin &lt;dbl&gt;, Smilesback &lt;dbl&gt;, Followswitheyesandhead &lt;dbl&gt;,
## #   Handsopennowandthen &lt;dbl&gt;, Looksatownhands &lt;dbl&gt;,
## #   Vocalizesresponsively &lt;dbl&gt;,
## #   Remainspositionedwhenliftedunderthearmpits &lt;dbl&gt;,
## #   Holdsheadupfortyfivedegreesinproneposition &lt;dbl&gt;,
## #   Handsplayinginmidline &lt;dbl&gt;, Graspstoywithinreach &lt;dbl&gt;,
## #   Noheadlagwhenpulledtosittingposition &lt;dbl&gt;, Turnsheadtosound &lt;dbl&gt;,
## #   Whenliftedverticallylegsbendedortrampling &lt;dbl&gt;,
## #   Holdsheadupninetydegreesinproneposition &lt;dbl&gt;,
## #   Transferstoyeasilyhandtohand &lt;dbl&gt;,
## #   Picksuponesmalltoythensecond &lt;dbl&gt;, Playswithbothfeet &lt;dbl&gt;,
## #   Rollsfrompronetosupineandback &lt;dbl&gt;,
## #   Holdsheadupinsittingposition &lt;dbl&gt;, Sitswithstretchedlegs &lt;dbl&gt;,
## #   Saysdadababaorgaga &lt;dbl&gt;, Sitswithoutsupport &lt;dbl&gt;,
## #   Picksupcrumbbetweenthumbandindexfinger &lt;dbl&gt;, Crawls &lt;dbl&gt;,
## #   Pullshimselftostandingposition &lt;dbl&gt;, Wavesbyebye &lt;dbl&gt;,
## #   Jabbering &lt;dbl&gt;, Getscubeintoandoutofbox &lt;dbl&gt;,
## #   Playsgiveandtake &lt;dbl&gt;, Crawlswithbellyliftedofheground &lt;dbl&gt;,
## #   Walkswhileholdingfurniture &lt;dbl&gt;, Understandssomesimplewords &lt;dbl&gt;,
## #   Usestwowords &lt;dbl&gt;, Makestoweroftwocubes &lt;dbl&gt;, Exploresroom &lt;dbl&gt;,
## #   Usesthreewords &lt;dbl&gt;, Identifiestwonamedobjects &lt;dbl&gt;,
## #   Walksonitsown &lt;dbl&gt;, Throwsballwithoutfalling &lt;dbl&gt;,
## #   Makestowerofthreecubes &lt;dbl&gt;, Imitateseverydayactivities &lt;dbl&gt;,
## #   Drinksfromcup &lt;dbl&gt;, Makestwowordsentences &lt;dbl&gt;,
## #   Putsballinboxwhenasked &lt;dbl&gt;, Squats &lt;dbl&gt;, Walkswell &lt;dbl&gt;,
## #   Makestowerofsixcubes &lt;dbl&gt;, Putsroundfigureintoplace &lt;dbl&gt;,
## #   Takesoffaclothshoesocktrousers &lt;dbl&gt;, Eatswithspoonwithouthelp &lt;dbl&gt;,
## #   CallsitselfbynameorI &lt;dbl&gt;, Identifiespicturesinbook &lt;dbl&gt;,
## #   Kicksballaway &lt;dbl&gt;, dscore &lt;dbl&gt;, daz &lt;dbl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(popsdemo)</code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(popsdemo)</code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>The are 25 children and 4 time points.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 25 children, 4 time points per child</span>
<span class="kw">length</span>(<span class="kw">unique</span>(popsdemo$patid))</code></pre></div>
<pre><code>## [1] 25</code></pre>
<p>The item scores that form the test are located in columns 9-65.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test &lt;-<span class="st"> </span><span class="dv">9</span>:<span class="dv">65</span></code></pre></div>
<p>These names of the columns need to be matched against one of the lexicons in the item bank. The built-in lexicons are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(itembank)[<span class="dv">1</span>:<span class="dv">6</span>]</code></pre></div>
<pre><code>## [1] &quot;lex.dutch1996&quot; &quot;lex.dutch2005&quot; &quot;lex.dutch1983&quot; &quot;lex.SMOCC&quot;    
## [5] &quot;lex.GHAP&quot;      &quot;lex.jam&quot;</code></pre>
<p>We first need to find out a proper lexicon for the data. For the POPS data, the closest lexicon is . Let us check the variable names in POPS with the item labels in the item bank.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">itemset &lt;-<span class="st"> </span>!<span class="kw">is.na</span>(itembank$lex.dutch1983)
<span class="kw">cbind</span>(<span class="kw">names</span>(popsdemo)[test], itembank[itemset, <span class="kw">c</span>(<span class="st">&quot;lex.dutch1983&quot;</span>, <span class="st">&quot;labelEN&quot;</span>, <span class="st">&quot;tau&quot;</span>)])</code></pre></div>
<pre><code>##                         names(popsdemo)[test] lex.dutch1983
## 1                                 Fixateseyes            v1
## 2                              Reactstospeech            v2
## 3                  Movesbotharmsequallyasmuch            v3
## 6                  Movesbothlegsequallyasmuch            v4
## 9                                   Liftschin            v5
## 10                                 Smilesback            v6
## 11                     Followswitheyesandhead            v7
## 14                        Handsopennowandthen            v8
## 17                            Looksatownhands            v9
## 18                      Vocalizesresponsively           v10
## 19 Remainspositionedwhenliftedunderthearmpits           v11
## 20 Holdsheadupfortyfivedegreesinproneposition           v12
## 23                      Handsplayinginmidline           v13
## 24                       Graspstoywithinreach           v14
## 27       Noheadlagwhenpulledtosittingposition           v15
## 28                           Turnsheadtosound           v16
## 31  Whenliftedverticallylegsbendedortrampling           v17
## 34    Holdsheadupninetydegreesinproneposition           v18
## 35               Transferstoyeasilyhandtohand           v19
## 36               Picksuponesmalltoythensecond           v20
## 37                          Playswithbothfeet           v21
## 40              Rollsfrompronetosupineandback           v22
## 41               Holdsheadupinsittingposition           v23
## 42                      Sitswithstretchedlegs           v24
## 43                         Saysdadababaorgaga           v25
## 45                         Sitswithoutsupport           v26
## 46     Picksupcrumbbetweenthumbandindexfinger           v27
## 49                                     Crawls           v28
## 50             Pullshimselftostandingposition           v29
## 51                                Wavesbyebye           v30
## 52                                  Jabbering           v31
## 54                    Getscubeintoandoutofbox           v32
## 57                           Playsgiveandtake           v33
## 58            Crawlswithbellyliftedofheground           v34
## 59                 Walkswhileholdingfurniture           v35
## 60                 Understandssomesimplewords           v36
## 61                               Usestwowords           v37
## 63                       Makestoweroftwocubes           v38
## 66                               Exploresroom           v39
## 67                             Usesthreewords           v40
## 68                  Identifiestwonamedobjects           v41
## 69                              Walksonitsown           v42
## 70                   Throwsballwithoutfalling           v43
## 74                     Makestowerofthreecubes           v44
## 77                 Imitateseverydayactivities           v45
## 78                              Drinksfromcup           v46
## 79                      Makestwowordsentences           v47
## 80                     Putsballinboxwhenasked           v48
## 81                                     Squats           v49
## 82                                  Walkswell           v50
## 84                       Makestowerofsixcubes           v51
## 85                   Putsroundfigureintoplace           v52
## 86             Takesoffaclothshoesocktrousers           v53
## 87                   Eatswithspoonwithouthelp           v54
## 88                       CallsitselfbynameorI           v55
## 89                   Identifiespicturesinbook           v56
## 90                              Kicksballaway           v57
##                                                          labelEN  tau
## 1                                                    Eyes Fixate  5.4
## 2                                          Reacts when spoken to  1.7
## 3                                        Moves arms equally well -2.2
## 6                                        Moves legs equally well -1.9
## 9                              Lifts chin off table for a moment  5.2
## 10                                            Smiles in response 11.3
## 11                                    Follows with eyes and head 14.5
## 14                                       Hands occasionally open 16.5
## 17                                             Watches own hands 20.7
## 18                                         Vocalizes in response 14.5
## 19                     Stays suspended when lifted under armpits 15.8
## 20                    Lifts head to 45 degrees in prone position 20.0
## 23                                   Plays with hands in midline 28.2
## 24                   Supine position: grasps object within reach 29.9
## 27                                Reactions if pulled to sitting 26.0
## 28                                           Turns head to sound 31.1
## 31                       Flexes or stomps legs while being swung 25.7
## 34         Looks around to side with angle face-table 90 degrees 27.8
## 35                                 Passes cube from hand to hand 36.0
## 36                Holds cube, grasps another one with other hand 36.5
## 37                                          Plays with both feet 33.2
## 40                                    Rolls over, back and forth 34.7
## 41                              Balances head well while sitting 32.5
## 42                         Sits on buttocks while legs stretched 34.9
## 43                                Says &quot;dada&quot;, &quot;baba&quot;, or &quot;gaga&quot; 36.0
## 45                      Sits in stable position, without support 40.0
## 46                Picks up pellet between thumb and index finger 43.1
## 49                          Crawls forward, abdomen on the floor 43.1
## 50                                 Pulls up to standing position 44.3
## 51                                              Waves &quot;bye bye&quot;  43.1
## 52                  Jabbering while playing (M; can ask parents) 40.9
## 54                                 Puts cube in and out of a box 46.0
## 57                                         Plays &quot;give and take&quot; 46.5
## 58 Crawls, with belly lifted off the ground (M; can ask parents) 46.1
## 59                                                   Walks along 46.1
## 60            Understands some simple words (M; can ask parents) 45.7
## 61                       Says 2 &quot;sound-words&quot; with comprehension 50.1
## 63                                     Builds tower of two cubes 56.4
## 66                                          Explores environment 46.9
## 67                                                Says 3 &quot;words&quot; 53.2
## 68               Identfies (point / graps) two mentioned objects 55.4
## 69                                          Walks on his/her own 51.9
## 70                              Throws ball without falling down 56.0
## 74                                   Builds tower of three cubes 59.2
## 77                                              Imitates others  52.3
## 78            Drink from cup by him/herself (M; can ask parents) 58.5
## 79                                    Says &quot;sentences&quot;of 2 words 60.2
## 80                                   Puts ball in box when asked 57.8
## 81                             Squats or bends to pick up things 55.3
## 82                                       Walks well without help 55.5
## 84                                       Builds tower of 6 cubes 62.6
## 85                                 Places round form in form-box 60.3
## 86                                             Undresses himself 60.6
## 87             Eats with spoon without help (M; can ask parents) 58.5
## 88                              Refers to self using &quot;me&quot; or &quot;I&quot; 61.7
## 89                              Points at 5 pictures in the book 62.2
## 90                                                    Kicks ball 64.2</code></pre>
<p>In this case, we are lucky that all item names from the source data and the item bank match up exactly. In general, we will need to map carefully the names in the dataset to the names in the item bank. For POPS, we may take out the relevant parts of the item bank as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ib &lt;-<span class="st"> </span>itembank[itemset,<span class="kw">c</span>(<span class="st">&quot;lex.dutch1983&quot;</span>, <span class="st">&quot;lex.GHAP&quot;</span>, <span class="st">&quot;labelEN&quot;</span>, <span class="st">&quot;tau&quot;</span>)]
<span class="kw">head</span>(ib, <span class="dv">3</span>)</code></pre></div>
<pre><code>##   lex.dutch1983 lex.GHAP                 labelEN  tau
## 1            v1 GSFIXEYE             Eyes Fixate  5.4
## 2            v2  GSRSPCH   Reacts when spoken to  1.7
## 3            v3   GSMARM Moves arms equally well -2.2</code></pre>
<p>From here on, we will work in the GHAP lexicon. Renaming the source data is now done by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(popsdemo)[test] &lt;-<span class="st"> </span><span class="kw">as.character</span>(ib$lex.GHAP)</code></pre></div>
<p>The source data has now names that are recognized in the itembank. To check this, find the difficulties for each item by the <code>gettau()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gettau</span>(<span class="kw">names</span>(popsdemo)[test])</code></pre></div>
<pre><code>## GSFIXEYE  GSRSPCH   GSMARM   GSMLEG GSLFCHIN  GSSMILE   GSFEYE  GSHOPEN 
##      5.4      1.7     -2.2     -1.9      5.2     11.3     14.5     16.5 
##   GSLKHN  GSVOCAL     GSRP   GSHH45 GSHPLAYM    GSGRP GSNOHLAG  GSTHEAD 
##     20.7     14.5     15.8     20.0     28.2     29.9     26.0     31.1 
##  GSLBEND   GSHH90   GSTTOY   GSPTOY   GSPLFT  GSROLLS  GSHHSIT  GSSITST 
##     25.7     27.8     36.0     36.5     33.2     34.7     32.5     34.9 
##   GSSAYS  GSSITWS   GSPICK  GSCRAWL GSPULLST  GSWAVES GSJABBER   GSGETC 
##     36.0     40.0     43.1     43.1     44.3     43.1     40.9     46.0 
## GSPLAYGT  GSCRBLY  GSWALKS GSSIMPLE GSTWOWRD  GSMK2CB  GSEXPLR GSTHRWRD 
##     46.5     46.1     46.1     45.7     50.1     56.4     46.9     53.2 
##  GSIDOBJ GSWLKOWN  GSTBALL  GSMK3CB GSIMITAT GSDRNKCP GSTWOSEN GSPUTBAL 
##     55.4     51.9     56.0     59.2     52.3     58.5     60.2     57.8 
##   GSPKSQ  GSWLKWH  GSMKTW6 GSPUTFIG  GSTKCLO GSEATSPN  GSREFER GSID5OBJ 
##     55.3     55.5     62.6     60.3     60.6     58.5     61.7     62.2 
##    GSKIK 
##     64.2</code></pre>
</div>
<div id="reorganize-the-data-into-a-long-matrix" class="section level2">
<h2>Reorganize the data into a long matrix</h2>
<p>The <code>dscore()</code> function takes vectors of item scores, item names and ages. Rearringing the data makes it easy to extract the relevant vectors. We need to create a data set with the following variables: <code>patid</code>, <code>moment</code>, <code>age</code>, <code>daycor</code>, <code>item</code> and <code>score</code>, and select only the rows where we have an observed score.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)</code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>popsdemo %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(patid, moment, age, daycor, GSFIXEYE:GSKIK) %&gt;%
<span class="st">  </span><span class="kw">gather</span>(items, scores, GSFIXEYE:GSKIK, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">scores =</span> <span class="dv">1</span> -<span class="st"> </span>scores) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(patid, moment)</code></pre></div>
<pre><code>## Warning: attributes are not identical across measure variables; they will
## be dropped</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data</code></pre></div>
<pre><code>## # A tibble: 1,385 Ã— 6
##    patid moment   age daycor    items scores
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;chr&gt;  &lt;dbl&gt;
## 1      1      2   161     95 GSFIXEYE      1
## 2      1      2   161     95  GSRSPCH      1
## 3      1      2   161     95   GSMARM      1
## 4      1      2   161     95   GSMLEG      1
## 5      1      2   161     95 GSLFCHIN      1
## 6      1      2   161     95  GSSMILE      1
## 7      1      2   161     95   GSFEYE      1
## 8      1      2   161     95  GSHOPEN      1
## 9      1      2   161     95   GSLKHN      1
## 10     1      2   161     95  GSVOCAL      1
## # ... with 1,375 more rows</code></pre>
<p>There are <code>nrow(data)</code> records with a nonmissing item score. Note also that the item scores have been reversed, as POPS uses a zero for a PASS, and a one for a FAIL.</p>
</div>
<div id="calculate-d-score-and-daz" class="section level2">
<h2>Calculate D-score and DAZ</h2>
<p>For illustration, let us first calculate the D-score of the first child. There are 75 scores for this child, spread over four time points. This is a preterm child, so we correct calener age for gestational age as in <code>daycor</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">child1 &lt;-<span class="st"> </span><span class="kw">filter</span>(data, patid ==<span class="st"> </span><span class="dv">1</span>)

scores &lt;-<span class="st"> </span>child1$scores
items &lt;-<span class="st"> </span><span class="kw">as.character</span>(child1$items)
ages &lt;-<span class="st"> </span><span class="kw">round</span>(child1$daycor/<span class="fl">365.25</span>, <span class="dv">4</span>)

<span class="co"># calculate dscore and daz for each time point for given child</span>
(d &lt;-<span class="st"> </span><span class="kw">dscore</span>(scores, items, ages))</code></pre></div>
<pre><code>## 0.2601 0.6461 1.2129 2.5736 
##  25.25  42.73  55.42  70.97</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">daz</span>(d)</code></pre></div>
<pre><code>## 0.2601 0.6461 1.2129 2.5736 
##  0.159  0.920  0.788  0.595</code></pre>
<p>If desired, one may also back-calculate the D-score from the standard deviation score by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">zad</span>(<span class="kw">daz</span>(d))</code></pre></div>
<pre><code>## 0.2601 0.6461 1.2129 2.5736 
##  25.25  42.73  55.42  70.97</code></pre>
<p>If we specify the child identifier  as a by-group variable, we may calculate the D-score and DAZ for all children by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># use age corrected for gestational age</span>
data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(data)
data$ages &lt;-<span class="st"> </span><span class="kw">round</span>(data$daycor/<span class="fl">365.25</span>, <span class="dv">4</span>)

<span class="co"># calculate D-score and DAZ</span>
ds &lt;-<span class="st"> </span><span class="kw">split</span>(data, data$patid)
dl &lt;-<span class="st"> </span>parallel::<span class="kw">mclapply</span>(ds, <span class="dt">FUN =</span> dscore)
dazl &lt;-<span class="st"> </span><span class="kw">lapply</span>(dl, <span class="dt">FUN =</span> daz)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">patid =</span> <span class="kw">rep</span>(<span class="kw">as.numeric</span>(<span class="kw">names</span>(dl)), <span class="dt">times =</span> <span class="kw">unlist</span>(<span class="kw">lapply</span>(dl, length))),
  <span class="dt">ages =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">lapply</span>(dl, names))),
  <span class="dt">dscore =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(dl)),
  <span class="dt">daz =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(dazl)))
<span class="kw">head</span>(df)</code></pre></div>
<pre><code>##   patid   ages dscore    daz
## 1     1 0.2601  25.25  0.159
## 2     1 0.6461  42.73  0.920
## 3     1 1.2129  55.42  0.788
## 4     1 2.5736  70.97  0.595
## 5     4 0.2546  23.15 -0.416
## 6     4 0.5038  31.75 -1.202</code></pre>
</div>
<div id="combine-d-score-and-daz-with-source-data" class="section level2">
<h2>Combine D-score and DAZ with source data</h2>
<p>Finally, in order to do further analyses, we need to put the estimated D-score and DAZ back into the source data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># merge dscore and daz into popsdemo data</span>
popsdemo$ages &lt;-<span class="st"> </span><span class="kw">round</span>(popsdemo$daycor/<span class="fl">365.25</span>, <span class="dv">4</span>)
popsdemo &lt;-<span class="st"> </span><span class="kw">merge</span>(popsdemo, df, <span class="dt">all.x =</span> <span class="ot">TRUE</span>)
<span class="kw">head</span>(<span class="kw">select</span>(popsdemo, patid, moment, ages, dscore, daz))</code></pre></div>
<pre><code>##   patid moment   ages dscore    daz
## 1     1      2 0.2601  25.26  0.163
## 2     1      3 0.6461  42.72  0.916
## 3     1      4 1.2129  55.44  0.794
## 4     1      5 2.5736  70.82  0.541
## 5     4      2 0.2546  23.15 -0.416
## 6     4      3 0.5038  31.75 -1.202</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
